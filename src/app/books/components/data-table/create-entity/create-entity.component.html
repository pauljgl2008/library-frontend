<p-dialog [(visible)]="visible" [modal]="true" [closable]="false" [responsive]="true" [style]="{ width: '400px' }">
  <div *ngIf="entity">
    <h3 class="text-center">{{ formTitle }}</h3>

    <form [formGroup]="entityForm" (ngSubmit)="save()">
      <div *ngFor="let field of entityFields">
        <label for="{{ field.field }}">{{ field.label }}</label>

        <!-- Condici칩n para mostrar un input o un select -->
        <ng-container *ngIf="field.type !== 'select'; else selectField">
          <input id="{{ field.field }}" formControlName="{{ field.field }}" [type]="field.type"
            class="form-control mb-3" [placeholder]="'Ingresa ' + field.label" />
        </ng-container>

        <!-- Dropdown para el campo 'author' o 'status' -->
        <ng-template #selectField>
          <select id="{{ field.field }}" formControlName="{{ field.field }}" class="form-control mb-3">
            <!-- Usar ng-container para manejar ambas condiciones -->
            <ng-container *ngIf="field.field === 'status'">
              <option value="Disponible">Disponible</option>
              <option value="No disponible">No disponible</option>
            </ng-container>

            <ng-container *ngIf="field.field === 'author'">
              <option *ngFor="let option of authorOptions" [value]="option.id">
                {{ option.name }}
              </option>
            </ng-container>
          </select>
        </ng-template>

        <!-- Mensajes de error -->
        <div *ngIf="entityForm.get(field.field)?.touched && entityForm.get(field.field)?.invalid">
          <small class="text-danger" *ngIf="entityForm.get(field.field)?.hasError('required')">
            Este campo es obligatorio.
          </small>
          <small class="text-danger" *ngIf="entityForm.get(field.field)?.hasError('pattern')">
            Formato no v치lido.
          </small>
        </div>
            
      </div>

      <p-footer>
        <div class="d-flex justify-content-between align-items-center w-100" style="gap: 10px; padding: 0 20px;">
          <!-- Bot칩n Cancelar -->
          <button type="button" pButton [label]="cancelLabel" icon="pi pi-times" (click)="cancel()"
            class="p-button-danger p-button-raised p-button-rounded p-button-sm flex-fill">
          </button>

          <!-- Bot칩n Guardar -->
          <button type="submit" pButton [label]="submitLabel" icon="pi pi-check" [disabled]="entityForm.invalid"
            class="p-button-success p-button-raised p-button-rounded p-button-sm flex-fill">
          </button>
        </div>
      </p-footer>
    </form>
  </div>
</p-dialog>